diff(f,a) = -((2*a)/(a^2 - 5) + a/(((a^2 + b^2)^(1/2) - 7)*(a^2 + b^2)^(1/2)))/t

diff(f,b) = -b/(t*((a^2 + b^2)^(1/2) - 7)*(a^2 + b^2)^(1/2))

diff(diff(f,a),a) = a^2/(t*((a^2 + b^2)^(1/2) - 7)^2*(a^2 + b^2)) - 1/(t*((a^2 + b^2)^(1/2) - 7)*(a^2 + b^2)^(1/2)) + a^2/(t*((a^2 + b^2)^(1/2) - 7)*(a^2 + b^2)^(3/2))

diff(diff(f,b),b) = b^2/(t*((a^2 + b^2)^(1/2) - 7)^2*(a^2 + b^2)) - 1/(t*((a^2 + b^2)^(1/2) - 7)*(a^2 + b^2)^(1/2)) + b^2/(t*((a^2 + b^2)^(1/2) - 7)*(a^2 + b^2)^(3/2))

diff(diff(f,a),b) = (a*b)/(t*((a^2 + b^2)^(1/2) - 7)^2*(a^2 + b^2)) + (a*b)/(t*((a^2 + b^2)^(1/2) - 7)*(a^2 + b^2)^(3/2))

####################################################################################

diff(f,a) = - (2*a)/(t*(a^2 - 5)) - (2*a)/(t*(a^2 + b^2 - 7))
diff(f,b) =  -(2*b)/(t*(a^2 + b^2 - 7))
diff(diff(f,a),a) = (4*a^2)/(t*(a^2 + b^2 - 7)^2) - 2/(t*(a^2 - 5)) - 2/(t*(a^2 + b^2 - 7)) + (4*a^2)/(t*(a^2 - 5)^2)
diff(diff(f,b),b) = (4*b^2)/(t*(a^2 + b^2 - 7)^2) - 2/(t*(a^2 + b^2 - 7))
diff(diff(f,a),b) = (4*a*b)/(t*(a^2 + b^2 - 7)^2)
------------------------------------------------------------------------------------
diff(f,x(end-1)) = - (2*x(end-1))/(t*(x(end-1)^2 - (Wf*Mu*FN)^2)) - (2*x(end-1))/(t*(x(end-1)^2 + x(end)^2 - (Mu*FN)^2))

diff(f,x(end)) =  -(2*x(end))/(t*(x(end-1)^2 + x(end)^2 - (Mu*FN)^2))

diff(diff(f,x(end-1)),x(end-1)) = (4*x(end-1)^2)/(t*(x(end-1)^2 + x(end)^2 - (Mu*FN)^2)^2) - 2/(t*(x(end-1)^2 - (Wf*Mu*FN)^2)) - 2/(t*(x(end-1)^2 + x(end)^2 - (Mu*FN)^2)) + (4*x(end-1)^2)/(t*(x(end-1)^2 - (Wf*Mu*FN)^2)^2)

diff(diff(f,x(end)),x(end)) = (4*x(end)^2)/(t*(x(end-1)^2 + x(end)^2 - (Mu*FN)^2)^2) - 2/(t*(x(end-1)^2 + x(end)^2 - (Mu*FN)^2))

diff(diff(f,x(end-1)),x(end)) = (4*x(end-1)*x(end))/(t*(x(end-1)^2 + x(end)^2 - (Mu*FN)^2)^2)
####################################################################################
objective function: 
%%no log(b)%%
diff(f,a) = - 1/(2*a^(1/2)*(a^(1/2) + b^(1/2))^2) - 1/(2*a^(1/2)*(a^(1/2) + c^(1/2))^2)- 1/(a*t)
diff(diff(f,a)) = 1/(2*a*(a^(1/2) + b^(1/2))^3) + 1/(4*a^(3/2)*(a^(1/2) + b^(1/2))^2) + 1/(2*a*(a^(1/2) + c^(1/2))^3) + 1/(4*a^(3/2)*(a^(1/2) + c^(1/2))^2)+1/(a^2*t)
diff(diff(f,a),b) = 1/(2*a^(1/2)*b^(1/2)*(a^(1/2) + b^(1/2))^3)
------------------------------------------------------------------------------------
diff(f,(x((k-1)*4+1))) = - 1/(2*(x((k-1)*4+1))^(1/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^2) - 1/(2*(x((k-1)*4+1))^(1/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4-3))^(1/2))^2)-1/((x((k-1)*4-3))*t)
diff(diff(f,(x((k-1)*4+1)))) = 1/(2*(x((k-1)*4+1))*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^3) + 1/(4*(x((k-1)*4+1))^(3/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^2) + 1/(2*(x((k-1)*4+1))*((x((k-1)*4+1))^(1/2) + (x((k-1)*4-3))^(1/2))^3) + 1/(4*(x((k-1)*4+1))^(3/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4-3))^(1/2))^2)+1/((x((k-1)*4-3))^2*t)
diff(diff(f,(x((k-1)*4+1))),(x((k-1)*4+5))) = 1/(2*(x((k-1)*4+1))^(1/2)*(x((k-1)*4+5))^(1/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^3)
------------------------------------------------------------------------------------
diff(f,x(1)) = - 1/(2*x(1)^(1/2)*(x(1)^(1/2) + b0^(1/2))^2) -1/(x(1)*t)
diff(diff(f,x(1))) = 1/(2*x(1)*(x(1)^(1/2) + b0^(1/2))^3) + 1/(4*x(1)^(3/2)*(x(1)^(1/2) + b0^(1/2))^2)+1/(x(1)^2*t)
diff(diff(f,x(1)),x(5)) = 1/(2*x(1)^(1/2)*x(5)^(1/2)*(x(1)^(1/2) + x(5)^(1/2))^3)
------------------------------------------------------------------------------------
diff(f,x(end-3)) = - 1/(2*x(end-3)^(1/2)*(x(end-3)^(1/2) + x(end-7)^(1/2))^2) -1/(x(end-3)*t)
diff(diff(f,x(end-3))) = 1/(2*x(end-3)*(x(end-3)^(1/2) + x(end-7)^(1/2))^3) + 1/(4*x(end-3)^(3/2)*(x(end-3)^(1/2) + x(end-7)^(1/2))^2)+1/(x(end-3)^2*t)
diff(diff(f,x(end-3)),x(end-7)) = 1/(2*x(end-3)^(1/2)*x(end-7)^(1/2)*(x(end-3)^(1/2) + x(end-7)^(1/2))^3)
####################################################################################
gf(a) = - 1/(a*t) - d_phi/(2*a^(1/2)*(a^(1/2) + b^(1/2))^2) - d_phi/(2*a^(1/2)*(a^(1/2) + c^(1/2))^2)
h(a,a) = 1/(a^2*t) + d_phi/(2*a*(a^(1/2) + b^(1/2))^3) + d_phi/(4*a^(3/2)*(a^(1/2) + b^(1/2))^2) + d_phi/(2*a*(a^(1/2) + c^(1/2))^3) + d_phi/(4*a^(3/2)*(a^(1/2) + c^(1/2))^2)
h(a,b) = d_phi/(2*a^(1/2)*b^(1/2)*(a^(1/2) + b^(1/2))^3)
------------------------------------------------------------------------------------
gf(x(1)) = - 1/(x(1)*t) - d_phi/(2*x(1)^(1/2)*(x(1)^(1/2) + x(5)^(1/2))^2)
h(x(1),x(1)) = 1/(x(1)^2*t) + d_phi/(2*x(1)*(x(1)^(1/2) + x(5)^(1/2))^3) + d_phi/(4*x(1)^(3/2)*(x(1)^(1/2) + x(5)^(1/2))^2) + d_phi/(2*x(1)*(x(1)^(1/2) + b0^(1/2))^3) + d_phi/(4*x(1)^(3/2)*(x(1)^(1/2) + b0^(1/2))^2)
h(x(1),x(5)) = d_phi/(2*x(1)^(1/2)*x(5)^(1/2)*(x(1)^(1/2) + x(5)^(1/2))^3)
------------------------------------------------------------------------------------
gf((x((k-1)*4+1))) = - 1/((x((k-1)*4+1))*t) - d_phi/(2*(x((k-1)*4+1))^(1/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^2) - d_phi/(2*(x((k-1)*4+1))^(1/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4-3))^(1/2))^2)
h((x((k-1)*4+1)),(x((k-1)*4+1))) = 1/((x((k-1)*4+1))^2*t) + d_phi/(2*(x((k-1)*4+1))*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^3) + d_phi/(4*(x((k-1)*4+1))^(3/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^2) + d_phi/(2*(x((k-1)*4+1))*((x((k-1)*4+1))^(1/2) + (x((k-1)*4-3))^(1/2))^3) + d_phi/(4*(x((k-1)*4+1))^(3/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4-3))^(1/2))^2)
h((x((k-1)*4+1)),(x((k-1)*4+5))) = d_phi/(2*(x((k-1)*4+1))^(1/2)*(x((k-1)*4+5))^(1/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^3)
------------------------------------------------------------------------------------
gf(x(end-3)) = - 1/(x(end-3)*t) - d_phi/(2*x(end-3)^(1/2)*(x(end-3)^(1/2) + x(end-7)^(1/2))^2)
h(x(end-3),x(end-3)) = 1/(x(end-3)^2*t) + d_phi/(2*x(end-3)*(x(end-3)^(1/2) + x(end-7)^(1/2))^3) + d_phi/(4*x(end-3)^(3/2)*(x(end-3)^(1/2) + x(end-7)^(1/2))^2)
h(x(end-3),x(end-7)) = d_phi/(2*x(end-3)^(1/2)*x(end-7)^(1/2)*(x(end-3)^(1/2) + x(end-7)^(1/2))^3)
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
h(1,1) = 1/(x(1)^2*t) + 2*(d_phi/(2*x(1)*(x(1)^(1/2) + x(5)^(1/2))^3) + d_phi/(4*x(1)^(3/2)*(x(1)^(1/2) + x(5)^(1/2))^2) + d_phi/(2*x(1)*(x(1)^(1/2) + b0^(1/2))^3) + d_phi/(4*x(1)^(3/2)*(x(1)^(1/2) + b0^(1/2))^2));
h(1,5) = 2*(d_phi/(2*x(1)^(1/2)*x(5)^(1/2)*(x(1)^(1/2) + x(5)^(1/2))^3));
h(5,1) = h(1,5);
for k = 2:(size(x)/4-1)
    h((k-1)*4+1,(k-1)*4+1)=1/((x((k-1)*4+1))^2*t) +2*( d_phi/(2*(x((k-1)*4+1))*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^3) + d_phi/(4*(x((k-1)*4+1))^(3/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^2) + d_phi/(2*(x((k-1)*4+1))*((x((k-1)*4+1))^(1/2) + (x((k-1)*4-3))^(1/2))^3) + d_phi/(4*(x((k-1)*4+1))^(3/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4-3))^(1/2))^2));
    h((k-1)*4+5,(k-1)*4+1)=2*(d_phi/(2*(x((k-1)*4+1))^(1/2)*(x((k-1)*4+5))^(1/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^3));
    h((k-1)*4+1,(k-1)*4+5)=h((k-1)*4+5,(k-1)*4+1);
end
h(end-3,end-3) = 1/(x(end-3)^2*t) + 2*(d_phi/(2*x(end-3)*(x(end-3)^(1/2) + x(end-7)^(1/2))^3) + d_phi/(4*x(end-3)^(3/2)*(x(end-3)^(1/2) + x(end-7)^(1/2))^2));
------------------------------------------------------------------------------------
gf(1) = - 1/(x(1)*t) - 2*(d_phi/(2*x(1)^(1/2)*(x(1)^(1/2) + x(5)^(1/2))^2) + d_phi/(2*x(1)^(1/2)*(x(1)^(1/2) + b0^(1/2))^2));
for k = 2:(size(x)/4-1)
    gf((k-1)*4+1)=- 1/((x((k-1)*4+1))*t) - 2*(d_phi/(2*(x((k-1)*4+1))^(1/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4+5))^(1/2))^2) + d_phi/(2*(x((k-1)*4+1))^(1/2)*((x((k-1)*4+1))^(1/2) + (x((k-1)*4-3))^(1/2))^2));
end
gf(end-3) = - 1/(x(end-3)*t) - 2*(d_phi/(2*x(end-3)^(1/2)*(x(end-3)^(1/2) + x(end-7)^(1/2))^2)) ;
end
####################################################################################
gf(u1) = - (2*a)/(t*(a^2 - 5)) - (2*a)/(t*(a^2 + b^2 - 7))
gf(u2) = -(2*b)/(t*(a^2 + b^2 - 7))
h(u1,u1) = (4*a^2)/(t*(a^2 + b^2 - 7)^2) - 2/(t*(a^2 - 5)) - 2/(t*(a^2 + b^2 - 7)) + (4*a^2)/(t*(a^2 - 5)^2)
h(u2,u2) = (4*b^2)/(t*(a^2 + b^2 - 7)^2) - 2/(t*(a^2 + b^2 - 7))
h(u3,u3) = (4*a*b)/(t*(a^2 + b^2 - 7)^2)
------------------------------------------------------------------------------------
for k = 1:size(x)/4
    gf((k-1)*4+3) = - (2*(x((k-1)*4+3)))/(t*((x((k-1)*4+3))^2 - (Wf*Mu*FN)^2)) - (2*(x((k-1)*4+3)))/(t*((x((k-1)*4+3))^2 + (x((k-1)*4+4))^2 - (Mu*FN)^2));
    gf((k-1)*4+4) = -(2*(x((k-1)*4+4)))/(t*((x((k-1)*4+3))^2 + (x((k-1)*4+4))^2 - (Mu*FN)^2));
end
for k = 1:size(x)/4
    h((k-1)*4+3,(k-1)*4+3) = (4*(x((k-1)*4+3))^2)/(t*((x((k-1)*4+3))^2 + (x((k-1)*4+4))^2 - (Mu*FN)^2)^2)...
                            - 2/(t*((x((k-1)*4+3))^2 - (Wf*Mu*FN)^2))...
                            - 2/(t*((x((k-1)*4+3))^2 + (x((k-1)*4+4))^2 - (Mu*FN)^2)) ...
                            + (4*(x((k-1)*4+3))^2)/(t*((x((k-1)*4+3))^2 - (Wf*Mu*FN)^2)^2);
    h((k-1)*4+4,(k-1)*4+4) = (4*(x((k-1)*4+4))^2)/(t*((x((k-1)*4+3))^2 + (x((k-1)*4+4))^2 - (Mu*FN)^2)^2) ...
                            - 2/(t*((x((k-1)*4+3))^2 + (x((k-1)*4+4))^2 - (Mu*FN)^2));
    h((k-1)*4+3,(k-1)*4+4) = (4*(x((k-1)*4+3))*(x((k-1)*4+4)))/(t*((x((k-1)*4+3))^2 + (x((k-1)*4+4))^2 - (Mu*FN)^2)^2);
    h((k-1)*4+4,(k-1)*4+3)=h((k-1)*4+3,(k-1)*4+4);
end

####################################################################################
